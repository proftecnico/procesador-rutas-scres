<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scres¬© - Procesador de Rutas</title>
    <link rel="icon" href="logo.jpg" type="image/jpeg">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@12.0.0/dist/handsontable.full.min.css">
    
    <style>
        :root {
            --primary-color: #3b82f6; --primary-dark: #1d4ed8;
            --secondary-color: #475569; --success-color: #10b981;
            --warning-color: #f59e0b; --accent-orange: #ff6600;
            --bg-gradient-start: #f1f5f9; --bg-gradient-end: #e2e8f0;
            --header-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh; padding: 40px 20px; color: #334155;
        }

        .main-container {
            background: white; border-radius: 16px;
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.1);
            overflow: hidden; max-width: 1400px; margin: 0 auto;
        }

        /* Header */
        .header { background: var(--header-gradient); color: white; padding: 40px 30px; text-align: center; position: relative; }
        .header h1 { margin: 0; font-size: 2.2rem; font-weight: 700; }
        .brand-scres { font-family: 'Press Start 2P', cursive; font-size: 2rem; color: var(--accent-orange); text-shadow: 2px 2px 0px #000000; display: block; margin-bottom: 5px; }
        .brand-subtitle { font-size: 0.85rem; letter-spacing: 1px; color: #94a3b8; font-weight: 500; display: block; }
        .user-badge { position: absolute; top: 30px; right: 30px; background: rgba(255, 255, 255, 0.1); color: white; padding: 6px 16px; border-radius: 30px; font-size: 0.8rem; font-weight: 500; backdrop-filter: blur(5px); }

        /* Login */
        .login-container { max-width: 400px; margin: 80px auto; padding: 40px; background: white; border-radius: 16px; box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.1); border: 1px solid #f1f5f9; }
        .btn-login { background: var(--primary-color); border: none; padding: 14px; font-weight: 600; border-radius: 8px; margin-top: 10px; color: white; width: 100%; }
        .btn-login:hover { background: var(--primary-dark); }

        /* Content */
        .content-wrapper { padding: 40px; }
        .nav-tabs .nav-link.active { color: var(--primary-color); background: #eff6ff; font-weight: 600; }
        .table-section { background: white; margin-top: 25px; }
        .table-container { border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; }
        
        /* Botones */
        .btn-process { background-color: var(--success-color); border: none; padding: 12px 24px; color: white; font-weight: 600; border-radius: 8px; }
        .btn-save { background-color: var(--warning-color); border: none; color: white; border-radius: 8px; }

        /* Output Console */
        .output { background: #1e293b; color: #34d399; padding: 25px; border-radius: 12px; font-family: monospace; font-size: 0.85rem; line-height: 1.6; max-height: 300px; overflow-y: auto; margin-top: 20px; }

        /* Utilidades */
        .loading-overlay { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); }
        .alert-custom { position: fixed; top: 20px; right: 20px; z-index: 10000; min-width: 300px; border-left: 4px solid currentColor; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .info-badge { background: #eff6ff; color: #2563eb; padding: 8px 16px; border-radius: 6px; font-size: 0.85rem; font-weight: 500; border: 1px solid #dbeafe; }
    </style>
</head>
<body>
    <div class="main-container">
        <div id="login-form">
            <div class="login-container">
                <div class="text-center mb-4">
                    <small class="text-muted text-uppercase fw-bold" style="letter-spacing: 2px;">Bienvenido a</small>
                    <div class="brand-scres mt-2">SCRES¬©</div>
                    <span class="brand-subtitle" style="color: var(--accent-orange);">By Jorge Garavagno</span>
                </div>
                <h2>Iniciar Sesi√≥n</h2>
                <form onsubmit="login(event)">
                    <div class="mb-3">
                        <label class="form-label">Usuario</label>
                        <input type="text" class="form-control" id="username" placeholder="Ej: Aesa" required>
                    </div>
                    <div class="mb-4">
                        <label class="form-label">Contrase√±a</label>
                        <input type="password" class="form-control" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="btn btn-login">Acceder al Sistema</button>
                </form>
            </div>
        </div>
        
        <div id="main-content" style="display: none;">
            <div class="header">
                <div class="brand-container">
                    <div class="brand-scres">SCRES¬©</div>
                    <span class="brand-subtitle">By Jorge Garavagno</span>
                </div>
                <h1>Procesador de Rutas Urbanas</h1>
                <div class="user-badge" id="userBadge"></div>
            </div>

            <div class="content-wrapper">
                <ul class="nav nav-tabs">
                    <li class="nav-item"><a class="nav-link active" href="#ptos" data-bs-toggle="tab">Tabla Ptos</a></li>
                    <li class="nav-item" id="admin-tab" style="display: none;"><a class="nav-link" href="#base" data-bs-toggle="tab">Base de Datos (Admin)</a></li>
                </ul>
                
                <div class="tab-content">
                    <div class="tab-pane active" id="ptos">
                        <div class="table-section">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h2>Tabla de Puntos</h2>
                                <div class="info-badge">üìã Pega los datos desde Excel</div>
                            </div>
                            
                            <div class="table-container" id="ptos-table"></div>
                            
                            <div class="mt-4">
                                <div class="mb-3">
                                    <button class="btn btn-process w-100" onclick="processData()">‚ö° 1. Procesar Datos</button>
                                </div>

                                <div class="card bg-light border-0 p-3">
                                    <h6 class="text-muted mb-3 text-uppercase fw-bold" style="font-size: 0.75rem;">Opciones de Env√≠o</h6>
                                    <div class="d-flex flex-wrap gap-3">
                                        
                                        <div class="bg-white p-3 rounded border flex-fill">
                                            <div class="d-flex align-items-center mb-2">
                                                <div id="serialStatusDot" style="width:10px; height:10px; border-radius:50%; background:#ef4444; margin-right:8px;"></div>
                                                <span id="serialStatusText" class="small fw-bold text-muted">USB Desconectado</span>
                                            </div>
                                            <div class="d-grid gap-2">
                                                <button class="btn btn-outline-secondary btn-sm" onclick="connectArduino()">üîå Conectar Arduino</button>
                                                <button class="btn btn-primary btn-sm" id="btnSendArduino" onclick="sendToArduino()" disabled>üì§ Enviar a Arduino</button>
                                            </div>
                                        </div>

                                        <div class="bg-white p-3 rounded border flex-fill">
                                            <div class="d-flex align-items-center mb-2">
                                                <span class="small fw-bold text-muted">ü§ñ Agente Local (.exe)</span>
                                                <span id="agentStatus" class="ms-auto small text-muted"></span>
                                            </div>
                                            <div class="d-grid">
                                                <button class="btn btn-dark btn-sm" id="btnSendAgent" onclick="sendToLocalAgent()" disabled>üì° Enviar v√≠a Script</button>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            
                            <div id="output" class="output"></div>
                        </div>
                    </div>
                    
                    <div class="tab-pane" id="base">
                        <div class="table-section">
                            <h2>Base de Datos de Unidades</h2>
                            <div class="alert alert-warning">‚ö†Ô∏è Solo administradores.</div>
                            <div class="table-container" id="base-table"></div>
                            <button class="btn btn-save mt-3" onclick="saveBase()">üíæ Guardar Cambios</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="routeModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="routeModalLabel">Configuraci√≥n de Ruta</h5>
                    </div>
                    <div class="modal-body">
                        <form id="routeForm">
                            <div class="mb-3"><label class="form-label">Unidad</label><input type="text" class="form-control" id="unidad" required></div>
                            <div class="row g-3">
                                <div class="col-6"><label class="form-label">Inicio Fecha</label><input type="date" class="form-control" id="fechaInicio" required></div>
                                <div class="col-6"><label class="form-label">Fin Fecha</label><input type="date" class="form-control" id="fechaFin" required></div>
                            </div>
                            <div class="row g-3 mt-2">
                                <div class="col-6"><label class="form-label">Hora Inicio</label><input type="time" class="form-control" id="inicioHora" required></div>
                                <div class="col-6"><label class="form-label">Hora Fin</label><input type="time" class="form-control" id="finHora" required></div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="submitRoute">Confirmar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/handsontable@12.0.0/dist/handsontable.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    
    <script>
       const FECHA_VENCIMIENTO_WEB=new Date('2026-03-23');let role='',ptosHot,baseHot,processing=![],generatedData=[],port,writer,isArduinoConnected=![];const baseData=[['Unidades','IMEI','ID','IMEI\x20LENG','ID\x20LENG','','',''],[0x3f8,0x310f561214fda,'003535',0xf,0x6,'','',''],[0x3f9,0x310f56121cd68,'003438',0xf,0x6,'','',''],[0x3fa,0x310f56132c02a,'003519',0xf,0x6,'',-0x13b119657b556,-0x212c6df629597],[0x3fb,0x310f56132c520,'003332',0xf,0x6,'','',''],[0x40d,0x3121fa481d502,'050384',0xf,0x6,'','','']];!localStorage['getItem']('baseData')&&localStorage['setItem']('baseData',JSON['stringify'](baseData));async function connectArduino(){if('serial'in navigator)try{port=await navigator['serial']['requestPort'](),await port['open']({'baudRate':0x2580});const _0xd64516=new TextEncoderStream(),_0x30e759=_0xd64516['readable']['pipeTo'](port['writable']);writer=_0xd64516['writable']['getWriter'](),isArduinoConnected=!![],updateArduinoUI(!![]),showAlert('üîå\x20Arduino\x20conectado\x20correctamente','success');}catch(_0x1ad02b){console['error']('Error:',_0x1ad02b),showAlert('‚ùå\x20Error\x20conectando\x20Arduino:\x20'+_0x1ad02b['message'],'danger');}else showAlert('‚ö†Ô∏è\x20Navegador\x20no\x20compatible\x20con\x20USB\x20Serial.\x20Use\x20Chrome.','warning');}function updateArduinoUI(_0x32d017){const _0x53457a=document['getElementById']('serialStatusDot'),_0x9605e9=document['getElementById']('serialStatusText'),_0x1285b2=document['getElementById']('btnSendArduino');if(_0x32d017){_0x53457a['style']['background']='#10b981',_0x9605e9['textContent']='Conectado',_0x9605e9['style']['color']='#10b981';if(generatedData['length']>0x0)_0x1285b2['disabled']=![];}else _0x53457a['style']['background']='#ef4444',_0x9605e9['textContent']='Desconectado',_0x1285b2['disabled']=!![];}async function sendToArduino(){if(!isArduinoConnected||!writer)return showAlert('Conecta\x20el\x20Arduino\x20primero','warning');const _0x7c4111=document['getElementById']('btnSendArduino');_0x7c4111['disabled']=!![],_0x7c4111['innerHTML']='Enviando...';try{for(let _0x2ce3c4=0x0;_0x2ce3c4<generatedData['length'];_0x2ce3c4++){const _0x13be62=generatedData[_0x2ce3c4];if(_0x13be62['trim']()){await writer['write'](_0x13be62+'\x0a'),document['getElementById']('output')['innerHTML']+='<div\x20style=\x22color:#3b82f6;\x20font-size:0.8em\x22>üîå\x20USB:\x20Enviando\x20'+(_0x2ce3c4+0x1)+'/'+generatedData['length']+'...</div>';const _0x57eac4=document['getElementById']('output');_0x57eac4['scrollTop']=_0x57eac4['scrollHeight'],await new Promise(_0xe22dc3=>setTimeout(_0xe22dc3,0x3e8));}}showAlert('‚úÖ\x20Env√≠o\x20a\x20Arduino\x20completado','success');}catch(_0x320cdb){showAlert('‚ùå\x20Error\x20USB:\x20'+_0x320cdb['message'],'danger');}finally{_0x7c4111['disabled']=![],_0x7c4111['innerHTML']='üì§\x20Enviar\x20a\x20Arduino';}}async function sendToLocalAgent(){if(generatedData['length']===0x0)return showAlert('No\x20hay\x20datos\x20para\x20enviar','warning');const _0xf3fd59=document['getElementById']('btnSendAgent'),_0x271a74=document['getElementById']('agentStatus');_0x271a74['textContent']='üîç\x20Buscando\x20.exe...';try{await fetch('http://127.0.0.1:5000/status');}catch(_0x239a9d){showAlert('‚ùå\x20No\x20se\x20encuentra\x20el\x20Agente\x20(.exe).\x20Ejec√∫talo\x20primero.','danger'),_0x271a74['textContent']='üî¥\x20Desconectado';return;}_0xf3fd59['disabled']=!![],_0xf3fd59['innerHTML']='‚è≥\x20Enviando...',_0x271a74['textContent']='üü¢\x20Enviando...',_0x271a74['style']['color']='green';try{const _0x118204=await fetch('http://127.0.0.1:5000/enviar',{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'lines':generatedData})}),_0x280ef0=await _0x118204['json']();if(_0x118204['ok'])showAlert('‚úÖ\x20Agente:\x20'+_0x280ef0['processed']+'\x20l√≠neas\x20enviadas.','success'),_0x271a74['textContent']='‚úÖ\x20Listo';else throw new Error(_0x280ef0['error']);}catch(_0x2e64ed){showAlert('‚ùå\x20Error\x20Agente:\x20'+_0x2e64ed['message'],'danger'),_0x271a74['textContent']='üî¥\x20Error',_0x271a74['style']['color']='red';}finally{_0xf3fd59['disabled']=![],_0xf3fd59['innerHTML']='üì°\x20Enviar\x20v√≠a\x20Script';}}async function obtenerFechaInternet(){try{const _0x5923db=await fetch(window['location']['href'],{'method':'HEAD','cache':'no-store'}),_0x7a78f4=_0x5923db['headers']['get']('date');if(!_0x7a78f4){const _0x1afb75=await fetch('https://worldtimeapi.org/api/timezone/America/Argentina/Buenos_Aires');return new Date((await _0x1afb75['json']())['datetime']);}return new Date(_0x7a78f4);}catch(_0x153e9d){return null;}}async function login(_0x6e0f7f){_0x6e0f7f['preventDefault']();const _0x1737e6=document['querySelector']('.btn-login'),_0x57dca9=_0x1737e6['innerHTML'];_0x1737e6['disabled']=!![],_0x1737e6['innerHTML']='Verificando\x20fecha...';const _0x3340a8=document['getElementById']('username')['value']['trim'](),_0x438982=document['getElementById']('password')['value'],_0x450cbd=await obtenerFechaInternet();if(!_0x450cbd){showAlert('‚ö†Ô∏è\x20Sin\x20internet:\x20No\x20se\x20puede\x20validar\x20licencia.','warning'),_0x1737e6['disabled']=![],_0x1737e6['innerHTML']=_0x57dca9;return;}if(_0x3340a8==='admin'&&_0x438982==='adminpass')role='admin',startApp('üë§\x20Admin');else{if(_0x3340a8==='Aesa'&&_0x438982==='Salvadores'){if(_0x450cbd>FECHA_VENCIMIENTO_WEB){showAlert('‚õî\x20LICENCIA\x20VENCIDA\x20(Verificaci√≥n\x20Online).','danger'),_0x1737e6['disabled']=![],_0x1737e6['innerHTML']=_0x57dca9;return;}role='normal',startApp('üë§\x20Cliente\x20Aesa');}else showAlert('‚ùå\x20Credenciales\x20incorrectas','danger'),_0x1737e6['disabled']=![],_0x1737e6['innerHTML']=_0x57dca9;}}function startApp(_0x3975c9){document['getElementById']('login-form')['style']['display']='none',document['getElementById']('main-content')['style']['display']='block',document['getElementById']('userBadge')['innerHTML']=_0x3975c9;if(role==='admin')document['getElementById']('admin-tab')['style']['display']='block';initTables();}async function processData(){if(processing)return;processing=!![],document['querySelector']('.btn-process')['disabled']=!![],showLoading('Procesando...'),generatedData=[];try{const _0x33e29d=ptosHot['getData'](),_0x4605b6=_0x33e29d['slice'](0x1)['filter'](_0x1447eb=>_0x1447eb[0x0]&&_0x1447eb[0x0]['toString']()['trim']()!=='');if(_0x4605b6['length']===0x0)throw new Error('Sin\x20datos\x20para\x20procesar');const _0x3a2a09=new Set();_0x4605b6['forEach'](_0x26f194=>{if(_0x26f194[0x5])_0x26f194[0x5]['toString']()['split'](',')['forEach'](_0x5791e2=>{if(_0x5791e2['trim']())_0x3a2a09['add'](_0x5791e2['trim']());});});const _0x53a807=[..._0x3a2a09];if(_0x53a807['length']===0x0)throw new Error('No\x20se\x20encontraron\x20rutas\x20en\x20la\x20columna\x20\x22Rutas\x22');const _0x1b9b81={},_0x3d61a2=document['getElementById']('routeModal'),_0x21e077=new bootstrap['Modal'](_0x3d61a2);hideLoading();for(const _0x3e4a84 of _0x53a807){document['getElementById']('routeModalLabel')['innerText']='‚öôÔ∏è\x20Configurar\x20Ruta\x20'+_0x3e4a84;const _0xeaea18=document['getElementById']('routeForm');_0xeaea18['reset'](),document['getElementById']('fechaInicio')['value']=new Date(Date['now']()-0x5265c00)['toISOString']()['split']('T')[0x0],document['getElementById']('fechaFin')['value']=new Date()['toISOString']()['split']('T')[0x0];const _0x26fd02=await new Promise(_0x4d1f97=>{const _0xb33e99=()=>{const _0x304b93=document['getElementById']('unidad')['value'],_0x1b579a=document['getElementById']('fechaInicio')['value'],_0x286ef3=document['getElementById']('fechaFin')['value'],_0x5d806a=document['getElementById']('inicioHora')['value'],_0x29d5c7=document['getElementById']('finHora')['value'];if(_0x304b93&&_0x1b579a&&_0x286ef3&&_0x5d806a&&_0x29d5c7)_0x21e077['hide'](),document['getElementById']('submitRoute')['removeEventListener']('click',_0xb33e99),_0x4d1f97({'unidad':_0x304b93,'inicio':_0x1b579a+'\x20'+_0x5d806a,'fin':_0x286ef3+'\x20'+_0x29d5c7});else alert('Completa\x20todos\x20los\x20campos');};document['getElementById']('submitRoute')['addEventListener']('click',_0xb33e99),_0x21e077['show']();});_0x1b9b81[_0x3e4a84]=_0x26fd02;}showLoading('Generando...');let _0x3244f4='';_0x4605b6['forEach']((_0x360ac9,_0x4853c2)=>{const _0x166404=_0x33e29d['indexOf'](_0x360ac9),_0x397bb3=_0x360ac9[0x5]?_0x360ac9[0x5]['toString']()['split'](',')['map'](_0x49a912=>_0x49a912['trim']()):[];let _0xa32a05=null;for(const _0x43521d of _0x397bb3)if(_0x1b9b81[_0x43521d]){_0xa32a05=_0x1b9b81[_0x43521d];break;}if(!_0xa32a05||!_0x360ac9[0xc]||!_0x360ac9[0xd])return;ptosHot['setDataAtCell'](_0x166404,0xe,_0xa32a05['unidad']),ptosHot['setDataAtCell'](_0x166404,0xf,_0xa32a05['inicio']),ptosHot['setDataAtCell'](_0x166404,0x10,_0xa32a05['fin']);const _0x634d8d=parseFloat(_0x360ac9[0xc]),_0x7a5b1=parseFloat(_0x360ac9[0xd]),_0x368d1b=(_0x634d8d<0x0?'-':'')+Math['abs'](_0x634d8d)['toString']()['replace']('.','')['padEnd'](0xf,'0')['slice'](0x0,0x7),_0x42e805=(_0x7a5b1<0x0?'-':'')+Math['abs'](_0x7a5b1)['toString']()['replace']('.','')['padEnd'](0xf,'0')['slice'](0x0,0x6);ptosHot['setDataAtCell'](_0x166404,0xc,_0x368d1b),ptosHot['setDataAtCell'](_0x166404,0xd,_0x42e805);const _0x831c8b=moment(_0xa32a05['inicio']),_0x58a804=moment(_0xa32a05['fin']),_0x203eae=Math['floor'](Math['random']()*_0x58a804['diff'](_0x831c8b,'minutes')),_0x5a093d=_0x831c8b['clone']()['add'](_0x203eae,'minutes')['add'](0x3,'hours'),_0x395afa=JSON['parse'](localStorage['getItem']('baseData')),_0x5abb07=_0x395afa['find'](_0x4155c4=>_0x4155c4[0x0]==_0xa32a05['unidad']),_0x3458ab=_0x5abb07?_0x5abb07[0x1]:'#N/A',_0x12981e=_0x5abb07?_0x5abb07[0x2]:'#N/A',_0x19635c='>RUS03,'+_0x5a093d['format']('DDMMYYHHmmss')+_0x368d1b+_0x42e805+'2929900000734261011,'+_0x3458ab+',0000000'+(_0x360ac9[0x4]||'0')+',001;ID='+_0x12981e+';#IP1:000C;*07<';generatedData['push'](_0x19635c),_0x3244f4+=_0x19635c+'\x0a';}),ptosHot['render'](),document['getElementById']('output')['innerText']=_0x3244f4||'No\x20se\x20generaron\x20datos.';if(generatedData['length']>0x0){document['getElementById']('btnSendAgent')['disabled']=![];if(isArduinoConnected)document['getElementById']('btnSendArduino')['disabled']=![];}showAlert('‚úÖ\x20Procesado:\x20'+generatedData['length']+'\x20registros','success');}catch(_0x514707){showAlert('‚ùå\x20'+_0x514707['message'],'danger');}finally{processing=![],document['querySelector']('.btn-process')['disabled']=![],hideLoading();}}function initTables(){ptosHot=new Handsontable(document['getElementById']('ptos-table'),{'data':[['Direcci√≥n','Punto\x20de\x20recolecci√≥n','Mobiliario\x20urbano','Tipo','Tag','Rutas','Total','Pendientes','Promedio','Servicios','No\x20Op','Cumplimiento','Latitud','Longitud','Unidad','Inicio','Fin']],'rowHeaders':!![],'colHeaders':!![],'height':0x258,'licenseKey':'non-commercial-and-evaluation','minRows':0x32,'minCols':0x11,'contextMenu':!![],'manualColumnResize':!![],'stretchH':'all'});if(role==='admin'){const _0x10257b=JSON['parse'](localStorage['getItem']('baseData'));baseHot=new Handsontable(document['getElementById']('base-table'),{'data':_0x10257b||baseData,'rowHeaders':!![],'colHeaders':!![],'height':0x258,'licenseKey':'non-commercial-and-evaluation','minRows':0x32,'minCols':0x9,'contextMenu':!![],'manualColumnResize':!![],'stretchH':'all'});}}function saveBase(){if(role!=='admin')return;localStorage['setItem']('baseData',JSON['stringify'](baseHot['getData']())),showAlert('üíæ\x20Guardado','success');}function showAlert(_0x3d9b12,_0x586c07='info'){const _0x517757=document['createElement']('div');_0x517757['className']='alert\x20alert-'+_0x586c07+'\x20alert-custom\x20shadow-sm',_0x517757['innerHTML']=_0x3d9b12,document['body']['appendChild'](_0x517757),setTimeout(()=>_0x517757['remove'](),0xfa0);}function showLoading(_0x2d955b){const _0x5188e6=document['createElement']('div');_0x5188e6['className']='loading-overlay\x20position-fixed\x20top-0\x20start-0\x20w-100\x20h-100\x20d-flex\x20align-items-center\x20justify-content-center',_0x5188e6['id']='loadingOverlay',_0x5188e6['style']['zIndex']='9999',_0x5188e6['innerHTML']='<div\x20class=\x22bg-white\x20p-4\x20rounded-3\x20text-center\x20shadow\x22><div\x20class=\x22spinner-border\x20text-primary\x20mb-3\x22></div><p\x20class=\x22mb-0\x20fw-bold\x22>'+_0x2d955b+'</p></div>',document['body']['appendChild'](_0x5188e6);}function hideLoading(){const _0x360951=document['getElementById']('loadingOverlay');if(_0x360951)_0x360951['remove']();}document['addEventListener']('DOMContentLoaded',()=>{const _0x2df94c=new Date(),_0x479208=new Date(_0x2df94c);_0x479208['setDate'](_0x479208['getDate']()-0x1);const _0x412735=document['getElementById']('fechaInicio'),_0x3c6c6e=document['getElementById']('fechaFin');_0x412735&&_0x3c6c6e&&(_0x412735['value']=_0x479208['toISOString']()['split']('T')[0x0],_0x3c6c6e['value']=_0x2df94c['toISOString']()['split']('T')[0x0]);});
    </script>
</body>

</html>





